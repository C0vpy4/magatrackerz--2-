# МАГАtrackerz - Финансовый трекер

## Настройка проекта

### 1. Настройка базы данных Supabase

1. Создайте новый проект в [Supabase](https://supabase.com)
2. Выполните SQL-скрипт из файла `sql-functions.sql` в SQL-редакторе Supabase для создания необходимых функций, которые обходят ограничения RLS:

   - `create_user` - функция для создания пользователя
   - `get_user_by_email` - функция для получения пользователя по email
   - `create_default_categories` - функция для создания категорий по умолчанию

3. Убедитесь, что в настройках аутентификации Supabase включен провайдер Email/Password

### 2. Настройка переменных окружения

Создайте файл `.env.local` в корне проекта со следующими переменными:

\`\`\`
NEXT_PUBLIC_SUPABASE_URL=ваш_url_supabase
NEXT_PUBLIC_SUPABASE_ANON_KEY=ваш_anon_key_supabase
\`\`\`

### 3. Установка зависимостей и запуск проекта

\`\`\`bash
npm install
npm run dev
\`\`\`

### 4. Создание первого пользователя-администратора

1. Зарегистрируйтесь в приложении, используя форму регистрации
2. Войдите в SQL-редактор Supabase и выполните следующий запрос, чтобы сделать вашего пользователя администратором:

\`\`\`sql
UPDATE users SET role_id = 2 WHERE email = 'ваш_email@example.com';
\`\`\`

## Устранение неполадок

### Проблемы с авторизацией

Если у вас возникают проблемы с авторизацией:

1. Убедитесь, что SQL-функции созданы корректно
2. Проверьте, что пользователь существует в таблице `users`
3. Очистите кеш браузера и cookies, затем попробуйте войти снова

### Проблемы с доступом к защищенным страницам

Если вы не можете получить доступ к защищенным страницам после входа:

1. Проверьте консоль браузера на наличие ошибок
2. Убедитесь, что сессия Supabase Auth активна
3. Проверьте, что пользователь существует в таблице `users` с тем же email, что и в Auth

## Функциональность приложения

- **Авторизация**: регистрация и вход пользователей
- **Дашборд**: общий баланс, структура расходов, последние транзакции
- **Транзакции**: добавление, редактирование и удаление доходов и расходов
- **Бюджеты**: установка месячных лимитов по категориям расходов
- **Категории**: управление категориями доходов и расходов
- **Администрирование**: управление пользователями (только для администраторов)

## Технологии

- Next.js 13 (App Router)
- Supabase (аутентификация, база данных)
- Tailwind CSS
- shadcn/ui компоненты
- Recharts для визуализации данных
